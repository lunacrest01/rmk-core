# keyboard.toml — corrected for rmk-config parser
[keyboard]
name = "CORE"
product_name = "CORE"
vendor_id = 0x6272
product_id = 0x0002
manufacturer = "braxon"
chip = "nrf52840_ble"

# === Matrix ===
[matrix]
input_pins  = ["P0_06", "P0_08", "P0_17"]   # rows
output_pins = ["P0_20", "P0_22", "P1_00"]   # columns

# === Layout ===
[layout]
rows = 3
cols = 3
layers = 2

keymap = [
  [
    ["K00", "K01", "K02"],
    ["K10", "K11", "K12"],
    ["K20", "K21", "K22"]
  ],
  [
    ["_", "VOLD", "VOLU"],
    ["_", "MEDIA_PLAY", "_"],
    ["_", "_", "_"]
  ]
]

# === Input devices (encoder) ===
# rmk-config expects these keys (no `name` or `pin_push` here)
[[input_device.encoder]]
pin_a = "P1_04"
pin_b = "P1_06"
# Optional supported fields:
phase = 1             # 0 or 1 (try 1 if rotation seems inverted)
resolution = 4        # steps per "tick" — tune if you get too coarse/fine
reverse = false       # set true to invert rotation direction
internal_pullup = true  # enable internal pullups for encoder pins if needed

# IMPORTANT: encoder "push" switches are generally NOT declared here.
# If your encoder has a push switch, wire that switch to a spare matrix position
# (one of K00..K22) so it appears as a normal key in the keymap/vial.json.
# Alternatively, wire it to a dedicated input supported by RMK (check your RMK version docs).

[features]
vial = true
storage = true
ble = true

[ble]
enabled = true
battery_adc_pin = "vddh"
default_tx_power = 0
use_2m_phy = true

[storage]
# storage enabled by default
